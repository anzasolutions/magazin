<html><head><meta http-equiv=Content-Type content="text/html; charset=iso-8859-2"><link rel=stylesheet href=magazin.css TYPE=text/css><title>MagaZin #18 :: maj 2004</title></head><body link=#176B9A vlink=#176B9A alink=#176B9A leftmargin=1 topmargin=15 bgcolor=#F2F2F2><div align=center><center><table border=0 width=750 cellspacing=0 cellpadding=0 style="border: 1 solid #176B9A"><tr><td width=100% style="border-bottom: 1 solid #F2F2F2" bgcolor=#1C84BB height=18><div align=center><table border=0 width=720 cellspacing=0 cellpadding=0><tr><td width=295 valign=top class=9ptV><font color=#FFFFFF><img border=0 src=../img/dir_003.gif width=6 height=7><b> </b><font face=Arial size=1 color=#FFFFFF>MAGAZIN #1/2004 (18) </font></font><font color=#FFFFFF face=Arial size=1><img border=0 src=../img/dir_003.gif width=6 height=7> MAJ 2004</font></td></center><td valign=top class=9ptV><p align=right><font color=#FFFFFF><img border=0 src=../img/dir_003.gif width=6 height=7><b> </b><font face=Arial size=1>MULTIMEDIALNE PISMO INTERNETOWE</font></font></td></tr></table></div></td></tr><center><tr><td width=100% height=80 style="border-bottom: 1 solid #176B9A"><img border=0 src=../img/003_top.gif width=748 height=80></td></tr><tr><td width=100% style="border-bottom: 1 solid #176B9A" bgcolor=#D1E3EF height=20><div align=center><table border=0 width=720 cellspacing=0 cellpadding=0><tr><td width=295 valign=top class=9ptV><b><font color=#176B9A><img border=0 src=../img/kwad.gif width=8 height=8> KURSY</font></b></td><td valign=top class=9ptV></td></tr></table></div></td></tr><tr><td width=100% bgcolor=#B1D3E4 style="border-bottom: 1 solid #176B9A" background=../img/003_title/delphi9.gif><div align=center><table border=0 width=720 cellspacing=0 cellpadding=0 height=55><tr><td width=1 valign=top><p align=right></td><td width=60 valign=middle><p align=right></td><td width=580 valign=middle height=70><i><font face=impact size=7 color=#176B9A>&nbsp;</font></i></td></center><td width=80 valign=middle height=70><p align=right></td><center><td width=1 valign=top></td></tr></table></div></center></td></tr><tr><td width=100% style="border-bottom: 1 solid #176B9A" bgcolor=#D1E3EF><div align=center><center><table border=0 width=720 cellspacing=0 cellpadding=0 height=20><tr><td width=10><p class=9ptV><img border=0 src=../img/dir_003.gif width=6 height=7></td><td width=353><p class=9ptV><font color=#176B9A face=Tahoma><b>PC3T</b></font></td></center><td width=353><p class=9ptV align=right><img border=0 src=../img/dir_003.gif width=6 height=7> <a href=58.htm class=link2><font face=Tahoma color=#176B9A>poprzednia strona</font></a><font color=#176B9A face=Tahoma> </font><img border=0 src=../img/dir_003.gif width=6 height=7> <a href=spis.htm class=link2><font face=Tahoma color=#176B9A>spis tre¶ci</font></a><font color=#176B9A face=Tahoma> </font><img border=0 src=../img/dir_003.gif width=6 height=7> <a href=60.htm class=link2><font face=Tahoma color=#176B9A>nastêpna strona</font></a></td></tr></table></div></td></tr><center><tr><td width=100% valign=top background=../img/003_tlo2.gif><div align=center><table border=0 width=720 cellspacing=0 cellpadding=0><tr><td width=720 colspan=3 height=10></td></tr><tr><td width=350 valign=top class=9ptV></center><div align=center><table border=0 width=100% cellspacing=0 cellpadding=0 style="border-left: 5 solid #176B9A; border-bottom: 1 solid #176B9A"><tr><td width=100%><b><font color=#176B9A face=arial size=3>&nbsp;</font><font face=arial size=3>Projektowanie menu</font></b></td></tr></table></div><p style="line-height: 130%" align=justify><font color=#176B9A>Ostatnio robili¶my edytor tekstu. Stwierdzi³em, ¿e nie warto go kontynuowaæ (przynajmniej na razie), a poruszê za to wa¿ny temat: projektowanie menu. Trochê siê tym zajmowali¶my ostatnio, ale to jednak za ma³o.</font><br> <br> <img border=0 src=../img/bl3/003_n.gif style="float: left; margin-right: 4; margin-top: 4" width=46 height=39>a pocz±tek uruchamiamy Delphi (tak, tak... kliknij na ten przycisk Start...). Robimy nowy program. Wstawiamy obiekt TMainMenu i klikamy na niego podwójnie, ¿eby w³±czyæ edytor naszego menu (lub w Object Inspektorze klikamy na Items). W Object Inspektorze pojawiaj± siê w³a¶ciwo¶ci menu. Aby stworzyæ nowe menu rozwijane w w³a¶ciwo¶æ Caption wpisujemy np.: Plik. Tak stworzyli¶my nowe menu. Po prawej stronie pojawia siê miejsce na nowe menu, ale nas na razie interesuj± pozycje w menu Plik. Wiêc klikamy na Plik (dalej w Edytorze Menu). Rozwinie siê nam poni¿ej zawarto¶æ tego menu. Jak na razie jest puste (ale ju¿ tylko przez chwilkê...). Wybieramy pierwsz± woln± (i jedyn±) pozycjê. Tutaj tak samo jak w tworzeniu Menu, ¿eby utworzyæ now± pozycjê musimy wpisaæ albo text do wy¶wietlenia, albo nawê pozycji (je¶li wpiszesz nazwê to nasza pozycja bêdzie bez textu, natomiast jak wpiszesz do Caption to nazwa zostanie automatycznie utworzona. Zazwyczaj jest to, to samo co text pozycji tylko, ¿e z pominieniem polskich fontów i na koñcu jest dodawana cyfra). My na razie wpisujemy tam Nowy. Po wpisaniu i klikniêciu Enter pojawi siê nowa i utworzona przez nas pozycja z textem Nowy i pusta pozycja pod ni±. Spoko jej nie bêdzie je¶li nie podasz jej nazwy lub w³a¶ciwo¶ci Caption. Teraz utwórz pozycje: Otwórz i Zapisz. Przyda³oby siê teraz zrobiæ pozycjê Wyj¶cie, ale najpierw kliknij na menu w Delphi (File) i zobacz, gdzie znajduje siê pozycja Exit. Na koñcu, prawda (te¿ mi odkrycie), ale przed ni± jest jeszcze... taka kreska! My te¿ j± zrobimy, ¿aden problem. Kliknij na ostatni± woln± pozycjê w Menu i w Caption wpisz: - (my¶lnik lub jak kto woli znak odj±æ). Naci¶nij Enter. Co widzisz? Powsta³a ta kreseczka (tzw. seperator), a pod ni± znowu puste miejsce! I w³a¶nie tam wpisz Wyj¶cie. Nasze menu zaczyna przybieraæ jakie¶ kszta³ty, ale ¿eby jeszcze czego¶ Was nauczyæ znowu wróæcie do menu Delphi (File). Kliknijcie i najed¼cie na New. Jak widzicie rozwinê³o siê podmnenu. Pewnie teraz szukacie pozycji w Object Inspektorze lub w kodzie, ale tam nic nie znajdziesz.... ¿eby utworzyæ takie menu od pozycji Nowy musimy: klikn±æ na pozycjê Nowy (oczywi¶cie dalej w Edytorze Menu) i teraz klikn±æ prawym klawiszem (klawiatury :)) myszki na pozycjê Nowy. Poka¿e siê nam menu, a z niego musimy wybraæ "Create Submenu". I teraz widzimy jak obok naszego "Nowy" pojawia siê strza³ka i nowy pasek rozwijania. Teraz tak samo musimy utworzyæ nowe pozycje. Za³ó¿my, ¿e bêd± one takie: Plik txt i Plik bmp (nie przyszed³ mi do g³owy ¿aden inny przyk³ad). Wszystko gra. Jednak jak wiemy niektórzy wol± u¿ywaæ skrótów z klawiatury. Wiêc, kliknijmy na któr±¶ pozycjê w naszym menu i w Object Inspektorze znajd¼my w³a¶ciwo¶æ ShortCut. Tam wybierzemy skrót z klawiatury nam odpowiadaj±cy (nie trzeba bawiæ siê kodzie aby te skróty dzia³a³y, Delphi sam to zrobi). To wszystko je¶li chodzi o skrót, ale co siê stanie jak kto¶ woli np.: nacisn±æ lewy Alt+P (zerknij w Delphi, ¿e aby rozwin±æ menu File starczy nacisn±æ Alt + F. "F" jest podkre¶lone). Wiêc kliknij na któr±¶ z opcji i w w³a¶ciwo¶ci Caption wpisz (ten przyk³ad jest oparty na pozycji Plik) &amp;Plik. Dziêki temu "P" bêdzie podkre¶lone i po naci¶niêciu Alt + P rozwiniemy menu Plik. Nie musisz tego generowaæ w kodzie, Delphi sam to zrobi, jednak nigdzie tego nie znajdziesz. Spójrz czy masz w TMainMenu ustawion± w³a¶ciwo¶æ AutoHotKeys na maAutomatic. Wtedy powy¿szy skrót Delphi generuje automatycznie.<br> <br> Dodanie rysunku obok pozycji w menu mo¿emy zrealizowaæ na dwa sposoby: albo wybraæ po prostu w³a¶ciwo¶æ Bitmap, albo je¶li mamy kilka rysunków powtarzaj±cych siê, utworzyæ obiekt TimageList. Pó¼niej klikamy dwukrotnie i mamy nowe okienko: tam dodajemy, kasujemy rysunki. Teraz, aby taki rysunek by³ w menu musimy: we w³a¶ciwo¶ci obiektu TMainMenu wybraæ Images i tam znale¼æ obiekt TimageList (wcze¶niej utworzony). Dla ka¿dej pozycji w menu ustawiamy w³a¶ciwo¶æ ImageIndex na odpowiedni rysunek. Gotowe.<br> <br> Zanim omówimy resztê rzeczy trzeba wiedzieæ jak tworzyæ zdarzenia do naszych pozycji. Nic prostszego. Mo¿emy to zrobiæ na dwa sposoby. Pierwszy to: nowe menu pojawia siê w formularzu, wiêc starczy wybraæ interesuj±c± nas pozycje i... po prostu klikn±æ. Reszta dzieje siê jak w innych obiektach. Drugim sposobem jest wej¶cie do edytora menu, wybranie przez nas interesuj±cej pozycji i... niestety trzeba klikn±æ a¿ dwa razy ;).<br> <br> Teraz, gdy Was wtajemniczy³em mogê powiedzieæ t± resztê. Mianowicie chodzi mi (po g³owie) o w³a¶ciwo¶ci TMenuItem, czyli jeszcze kilka rzeczy, które mog± Wam siê przydaæ w projektowaniu menu.</p><div align=center><table border=0 width=100% cellspacing=0 cellpadding=0 style="border-left: 5 solid #176B9A; border-bottom: 1 solid #176B9A"><tr><td width=100%><b><font color=#176B9A face=arial size=3>&nbsp;</font><font face=arial size=3>Projektowanie dynamiczne (czyli podczas<br> &nbsp;dzia³ania programu</font></b></td></tr></table></div><p style="line-height: 130%" align=justify><b><font color=#176B9A>Add</font></b> - metoda Add dodaje do naszego menu now± pozycjê na koñcu menu.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>var<br> NowaPozycjaMenu: TMenuItem;<br> begin<br> NowaPozycjaMEnu := TMenuItem.Create(Self);<br> NowaPozycjaMenu.Caption := 'Nowa Pozycja';<br> {Tutaj ustaw jeszcze inne w³a¶ciwo¶ci}<br> Plik1.Add(NowaPozycjaMenu);<br> end;</font></p><p>&nbsp;</td><td width=21 valign=top class=9ptV></td><td width=349 valign=top class=9ptV><p style="line-height: 130%" align=justify><b><font color=#176B9A>Break</font></b> - w³a¶ciwo¶æ Break okre¶la czy menu dzieli siê na kolumny i w jaki sposób. Je¶li dzieli siê, to pozycja z której zosta³o menu podzielone idzie do nowo utworzonej kolumny.<br> Przyk³adzik: (najlepiej to robiæ w Object Inspektorze)<br> <br> <font color=#176B9A>Zapisz1.Break := mbBarBreak;</font><br> <br> Je¶li Break bêdzie równa³o siê mbNone, to nie bêdzie podzia³u na kolumny. Je¶li Break równe jest mbBreak, to menu jest podzielone na kolumny, ale bez seperatora jak siê dzieje, gdy Break równe jest mbBarBreak. Domy¶lnie jest mbNone. Rzadko ta w³a¶ciwo¶æ jest stosowana<br> <br> <b><font color=#176B9A>Checked</font></b> - w³a¶ciwo¶æ okre¶la czy pozycja jest zaznaczona takim, jak gdyby "V" (tick).<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>Zapisz1.Checked := True;</font><br> <br> <b><font color=#176B9A>Count</font></b> - pod t± w³a¶ciwo¶ci± jest podstawiona liczba pozycji w menu.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>var<br> ilosc:Integer;<br> begin<br> ilosc := Plik1.Count;<br> {teraz usuwamy ostatni± pozycjê w menu}<br> Plik1.Delete(ilosc);<br> end;</font><br> <br> <b><font color=#176B9A>Default</font></b> - pozycja, która ma t± w³a¶ciwo¶æ ustawion± na True, powoduje, ¿e po klikniêciu na menu dwukrotnie uruchamia swoj± procedurê OnClick. Jest to rzadko spotykane w programach, wiêc lepiej z tego nie korzystaj.<br> Przyk³adzik: (najlepiej to robiæ w Object Inspektorze)<br> <br> <font color=#176B9A>Zapisz1.Default := True;</font><br> <br> <b><font color=#176B9A>Delete</font></b> - dziêki temu usuwamy pozycjê w menu. Niestety musimy znaæ jej numer.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>var<br> ilosc:Integer;<br> begin<br> ilosc := Plik1.Count;<br> {teraz usuwamy ostatni± pozycjê w menu}<br> Plik1.Delete(ilosc);<br> end;</font><br> <br> <b><font color=#176B9A>Enabled</font></b> - w³a¶ciwo¶æ ta okre¶l czy pozycja menu jest aktywne.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>Zapisz1.Enabled := False; //ustaw na nieaktywne</font><br> <br> <b><font color=#176B9A>IndexOf</font></b> - w³a¶ciwo¶æ ta zawiera po³o¿enie pozycji w menu.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>var<br> ilosc:Integer;<br> begin<br> ilosc := Plik1.IndexOf(Zapisz1);<br> {teraz usuwamy ostatni± pozycjê w menu}<br> Plik1.Delete(ilosc);<br> end;</font><br> <br> <b><font color=#176B9A>Insert</font></b> - wstawia now± pozycjê w danym miejscu.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>var<br> NowaPozycjaMenu: TMenuItem;<br> ilosc:Integer;<br> begin<br> NowaPozycjaMEnu := TMenuItem.Create(Self);<br> NowaPozycjaMenu.Caption := 'Nowa Pozycja';<br> {Tutaj ustaw jeszcze inne w³a¶ciwo¶ci}<br> ilosc := Plik1.Count; //mo¿esz tu wstawiæ inn± liczbê, inaczej pozycja zostanie dodana na koñcu<br> Plik1.Insert(ilosc, NowaPozycjaMenu);<br> end;</font><br> <br> <b><font color=#176B9A>Items</font></b> - jest tablic± pozycji w menu.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>{mo¿emy np.: usun±æ pozycjê Zapisz je¶li jest trzecia}<br> if Plik1.Items[3].Caption = 'Zapisz' then Plik1.Delete(3);<br> {albo zmieniæ opis pozycji :) }<br> Plik1.Items[1].Caption := 'Spadaj';</font><br> <br> <b><font color=#176B9A>RadioItem</font></b> - w³a¶ciwo¶æ okre¶la czy pozycja jest zaznaczona przyciskiem radiowym.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>Zapisz1.Enabled := True;</font><br> <br> <b><font color=#176B9A>Remove</font></b> - usuwa z menu pozycjê.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>Plik1.Remove(Zapisz1);</font><br> <br> <b><font color=#176B9A>Visible</font></b> - okre¶la czy pozycja / menu jest widoczne.<br> <br> Przyk³adzik:<br> <br> <font color=#176B9A>Zapisz1.Visible := False;</font><br> <br> I tak w koñcu opisa³em prawie wszystkie w³a¶ciwo¶ci. Oczywi¶cie wiêkszo¶æ z tych rzeczy, które tu napisa³em, mog± byæ u¿yte w TPopupMenu, a nie tylko w MainMenu.</td></tr><tr><td width=694 valign=top height=10 colspan=3></td></tr></table></div></td></tr><tr><td width=100% bgcolor=#D1E3EF style="border-top: 1 solid #176B9A"><div align=center><table border=0 width=720 cellspacing=0 cellpadding=0 height=20><tr><td width=10><p class=9ptV><img border=0 src=../img/dir_003.gif width=6 height=7></td><td width=447><p class=9ptV><font color=#176B9A face=Tahoma>Copyright &copy; </font><b><font face=Tahoma color=#176B9A>MAGAZIN</font></b><font color=#176B9A face=Tahoma> 2001-2004 | Wszystkie prawa zastrze¿one</font></td><td width=259><p class=9ptV align=right><img border=0 src=../img/dir_003.gif width=6 height=7> <a href=58.htm class=link2><font face=Tahoma color=#176B9A>poprzednia strona</font></a><font color=#176B9A face=Tahoma> </font><img border=0 src=../img/dir_003.gif width=6 height=7> <a href=spis.htm class=link2><font face=Tahoma color=#176B9A>spis tre¶ci</font></a><font color=#176B9A face=Tahoma> </font><img border=0 src=../img/dir_003.gif width=6 height=7> <a href=60.htm class=link2><font face=Tahoma color=#176B9A>nastêpna strona</font></a></td></tr></table></div></td></tr><center></table></center></div></body></html>