<html><head><meta http-equiv=Content-Type content="text/html; charset=iso-8859-2"><link rel=stylesheet href=magazin.css TYPE=text/css><title>MagaZin #13 :: pa¼dziernik 2002</title></head><body link=#478DE7 vlink=#478DE7 alink=#478DE7 topmargin=0 bottommargin=0 bgcolor=#000000><div align=center><table border=0 width=650 style="border-style: solid; border-width: 0" cellspacing=0 cellpadding=0 height=100% bgcolor=#FFFFFF><tr><td width=100% height=70 valign=middle background=../img/003b.png><div align=center><table border=0 width=550 cellspacing=0 cellpadding=0 height=28><tr><td width=550 align=center height=26 valign=bottom><p class=9ptV align=right><font color=#FFFFFF><b>MAGAZIN #13 :: STRONA 21</b></font></td></tr></table></div></td></tr><center><tr><td width=100% height=20 valign=bottom></center><div align=center><table border=0 width=586 height=20 cellspacing=0 cellpadding=0><tr><td width=135 background=../img/line3.gif><p align=right><img border=0 src=../img/line.gif width=9 height=20></td><center><td width=310 valign=bottom><p align=center class=9ptV><a href=20.htm class=link2><font color=#2078A8>poprzednia strona</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=spis.htm class=link2><font color=#2078A8>spis tre¶ci</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=22.htm class=link2><font color=#2078A8>nastêpna strona</font></a></td><td width=135 background=../img/line3.gif><img border=0 src=../img/line2.gif width=9 height=20></td></tr></table></center></div></td></tr><center><tr><td width=100% height=5 valign=top><p class=9ptV>&nbsp;</td></tr><tr><td width=100% height=5 valign=top><div align=center><center><table border=0 width=590 cellspacing=0 cellpadding=0><tr><td width=590 valign=top class=9ptV height=20 style="border-bottom: 1 solid #2078A8" colspan=2><b><font color=#009830><img border=0 src=../img/kwad.gif width=8 height=8> </font></b><b><font color=#2078A8>KURSY</font></b></td></tr><tr><td width=528><p><font face=Impact size=7 color=#E0F0F8><span style="background-color: #2078A8">K</span></font><font face=Impact size=7 color=#000000>urs Delphi, cz. 4</font></td></center></center><td width=58 valign=middle></td></tr><center><center><tr><td width=588 valign=bottom class=9ptV height=20 colspan=2><a href=mailto:przempc@poczta.onet.pl class=link2><b><font color=#2078A8>PC3T</font></b></a></td></tr><tr><td width=588 height=10 colspan=2></td></tr></table></center></div></center></td></tr><tr><td width=100% height=21 valign=top><center><table border=0 width=600 cellspacing=0 cellpadding=6 height=20 bgcolor=#FFFFFF><tr><td width=285 height=20 valign=top class=9pt></center><p align=justify class=9ptV><font color=#2078A8>Kiedy piszê ten tekst to do koñca wakacji zosta³o jeszcze kupê czasu (jeden miesi±c to te¿ co¶ :)), a kiedy wy go bêdziecie czytaæ to pewnie znów zacznie siê rok szkolny. :( Na razie siê tym nie martwmy. Zaczynajmy wiêc...<br> Dzisiaj zaczniemy powolne poznawanie wiêkszo¶ci obiektów w Delphi. Pierwsza pod ostrza³ pójdzie paleta Standard i tylko ni± siê dzisiaj zajmiemy. Opisywaæ obiektów nie muszê prawda? Chyba ka¿dy wie do czego s³u¿±, chyba ¿e korzystacie z Linuxa itp. :)</font><br> <br> <img border=0 src=../img/003_n.gif style="float: left" width=22 height=38>apiszemy dzisiaj prosty program w sumie bezu¿yteczny dla u¿ytkownika, ale przydatny dla nas. Zerknijcie na rysunek poni¿ej i mniej wiêcej w taki sposób pouk³adajcie obiekty w formularzu:<font color=#000000><br> <img border=0 src=../img/delphi.gif style="border: 1 solid #000000; margin-top: 10; margin-bottom: 10" width=285 height=214><br> </font>Teraz pozmieniamy niektóre w³a¶ciwo¶ci niektórych obiektów. :)<br> Wszystkim obiektom <b>TLabel</b> i <b>TButton</b> oraz obiektom, które pominê, ustaw Caption wed³ug rysunku (w przypadku TEdit i TComboBox - Text).<br> <br> <b>TMainMenu</b> kliknijcie na niego dwukrotnie. Otworzy siê wam okienko edycji menu. Kliknijcie na pierwsz± pozycjê menu i ustawcie jej Caption na Plik. Naci¶nijcie Enter. Delphi stworzy nam pozycjê menu o nazwie plik. Kliknijcie teraz na pozycjê plik, a pó¼niej na pust± pozycjê pod nim. W Caption wpiszcie Wyj¶cie i naci¶nijcie znów Enter. Tym razem stworzyli¶my pozycjê podmenu. Obydwie pozycje maj± kilka innych w³a¶ciwo¶ci: Bitmap (obrazek obok nag³ówka), Break (przerwa miêdzy pozycjami), Checked (zaznaczenie), Enabled (aktywno¶æ obiektu), ShortCut (klawisz skrótu). To tylko niektóre w³a¶ciwo¶ci i aktualnie s± nam niepotrzebne... mo¿ecie ustawiæ klawisz sktótu, jak chcecie. Okno edycji menu zamykamy.<br> <br> <b>TPopupMenu</b> dwukrotne klikniêcie powoduje otworzenie okno edycji menu wyskakuj±cego (kliknijcie na pulpit prawym klawiszem... o w³a¶nie to :)). Tak samo jak powy¿ej tworzymy dwie pozycje Usuñ i Przesuñ. Tym razem nie mamy pozycji nadrzêdnej, tylko pozycje podmenu. Kiedy to zrobicie kliknijcie na pozycjê Przesuñ prawym klawiszem i wybierzcie opcjê Create Submenu. Stworzy to nam menu, które bêdzie mo¿na wy¶wietliæ po najechaniu kursorem na pozycjê przesuñ. W tym menu dajcie dwie pozycje: Na pocz±tek i Na koniec.<br> <br> <b>TPanel</b> wyczy¶æ jego Caption.<br> <br> <b>TMemo</b> kliknij na jego w³a¶ciwo¶æ Lines dwukrotnie i wyczy¶æ jego zawarto¶æ. W³a¶ciwo¶æ ScrollBars ustaw na ssVertical.<br> <br> <b>TGroupBox</b> ustaw jego Caption na Ustawienia.<br> <br> <b>TRadioGroup</b> w formularzu powiniene¶ mieæ dwa takie obiekty. Pierwszego Caption ustaw nba Kolor okna i dwukrotnie klikaj±c na jego w³a¶ciwo¶æ Items wstaw tam sze¶æ kolorów: Szary, Czarny, Bia³y, Czerwony, Niebieski i Zielony oddzielone Enterem. ItemIndex ustaw na 0. Spowoduje to zaznaczenie pierwszej pozycji (Szary). Z drugim obiektem TRadioGroup zrób tak samo, ale jego Caption ustaw na Kolor czcionkia ItemIndex na 1 (zaznaczy drug± pozycjê, Czarny).<br> <br> <b>ScrollBar</b> ich w³a¶ciwo¶æ Max oraz Position ustaw na 255.<br> <br> <b>Projektowanie wizualne... OK</b><br> <br> Czas kodowaæ! Kliknijcie na Form1. Wybierzcie jego zdarzenie OnCreate. Wpiszemy tam co¶ takiego:<br> <br><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.FormCreate(Sender: TObject);<br> <br> begin<br> ComboBox1.Items := Screen.Fonts;<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Powy¿sza procedura podstawi nam pod listê ComboBox1 wszystkie dostêpne zainstalowane czcionki w systemie. jak widzicie jest tutaj obiekt, którego nie wstawili¶my nigdzie: TScreen. Jest on automatycznie tworzony wraz z aplikacj±. Obiekt ten s³u¿y g³ównie do operacji zwi±zanych z ekranem, typu: rozdzielczo¶æ: Screen.Width, Screen.Height; aktywne okna, aktywne obiekty, ilo¶æ okien na ekranie, czcionki itp. Jeszcze kiedy¶ o nim bêdzie dok³adniej.<br> Kliknijcie na Plik -&gt; Wyj¶cie w naszej aplikacji i wpiszcie tak± oto procedurê:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.Wyjcie1Click(Sender: TObject);<br> begin<br> Application.Terminate;<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Powy¿sza procedura te¿ korzysta z obiektu tworzonego wraz z aplikacj±: TApplication. Przechowuje on wszystkie dane o aplikacji i wykonuje jej podstawowe procedury. Jedn± z nich jest Terminate, która powoduje zakoñczenie aplikacji. Mogli¶my jeszcze zamkn±æ nasz program poprzez wpisanie Form1.Close. Dzia³a to tylko wtedy, gdy zamykane okno jest g³ównym oknem aplikacji, a ono u nas jest.<br> Klikamy teraz na Button1 (Dodaj) i piszemy tak± procedurê:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.Button1Click(Sender: TObject);<br> begin<br> ListBox1.Items.Add(Edit2.Text + ' ' + Edit1.Text);<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Co ona powoduje? Do obiektu ListBox1 dodaje pozycjê, która ma zawieraæ tekst edi1, spacjê i edit2. Czyli imiê i nazwisko.<br> Teraz uruchomcie edytor menu dla TPopupMenu1 i naci¶nijcie na pozycjê Usuñ:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.Usu1Click(Sender: TObject);<br> begin<br> if ListBox1.Items.Count > 0 then<br> ListBox1.Items.Delete(ListBox1.ItemIndex);<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Ta procedura sprawdza najpierw czy ilo¶æ pozycji w ListBox1 jest wiêksza od zera (ListBox1.Items.Count zawiera liczbê pozycji w li¶cie). Je¶li tak to usuwamy zaznaczona pozycjê (ListBox1.Items.Delete(x) usuwa pozycjê numer x. Natomiast ListBox1.ItemIndex zawiera numer aktualnie zaznaczonej pozycji).<br> Teraz w tym samym menu wybieramy pozycjê Przenie¶ -&gt; Na pocz±tek i piszemy:</p><p class=9ptV align=justify></td><td width=285 height=20 valign=top class=9pt><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.Napocztek1Click(Sender: TObject);<br> begin<br> if ListBox1.Items.Count > 0 then<br> ListBox1.Items.Move(ListBox1.ItemIndex,0);<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Procedura sprawdza ilo¶æ pozycji w menu je¶li jakie¶ s± to Przesuwa zaznaczon± pozycjê na pocz±tek (ListBox1.Items.Move(Pozycja, NowaPozycja).<br> Teraz natomiast wybieramy pozycjê Przesuñ -> Na koniec:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.Nakoniec1Click(Sender: TObject);<br> begin<br> if ListBox1.Items.Count > 0 then<br> ListBox1.Items.Move(ListBox1.ItemIndex,<br> ListBox1.Items.Count-1);<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Procedura tak jak powy¿sza, ale zamiast zera dali¶my liczbê pozycji w menu zmniejszon± o jeden. Czyli na koniec.<br> Teraz wybierz RadioGroup1 kliknij dwukrotnie:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.RadioGroup1Click(Sender: TObject);<br> begin<br> Case RadioGroup1.ItemIndex of<br> 0: Form1.Color := clBtnFace;<br> 1: Form1.Color := clBlack;<br> 2: Form1.Color := clWhite;<br> 3: Form1.Color := clRed;<br> 4: Form1.Color := clBlue;<br> 5: Form1.Color := clGreen;<br> end;<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Powy¿sza procedura sprawdza, który przycisk radiowy zosta³ zaznaczony. Zero odpowiada pierwszemu, a 5 szóstemu. W zale¿no¶ci, który przycisk zosta³ zaznaczony podstawiany jest inny kolor t³a naszego formularza. Wyrazy zaczynaj±ce siê od "cl" to sta³e kolorów. Je¶li znacie angielski to powinni¶cie je rozpoznaæ. Tylko kolor clBtnFace jest kolorem, który mo¿e siê zmieniæ. Je¶li w winowsie kolor okna masz ustawiony na szaro to clBtnFace przyjmie kolor szary, je¶li na czarno to na czarny. Jeszcze o tym bêdzie tekst, oki?<br> <br> Teraz RadioGroup2:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.RadioGroup2Click(Sender: TObject);<br> begin<br> Case RadioGroup2.ItemIndex of<br> 0: Form1.Font.Color := clBtnFace;<br> 1: Form1.Font.Color := clBlack;<br> 2: Form1.Font.Color := clWhite;<br> 3: Form1.Font.Color := clRed;<br> 4: Form1.Font.Color := clBlue;<br> 5: Form1.Font.Color := clGreen;<br> end;<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Teraz podobna procedura jak powy¿sza, ale tym razem zmieniamy kolor czcionki okna.<br> Kliknijcie na CheckBox1 (Bold) i wpiszcie t± ciekawsz± procedurê:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.CheckBox1Click(Sender: TObject);<br> begin<br> if CheckBox1.Checked = true then<br> Form1.Font.Style := Form1.Font.Style + [fsBold]<br> else Form1.Font.Style := Form1.Font.Style - [fsBold];<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Procedura sprawdza czy CheckBox1 jest zaznaczony: je¶li tak to zmienia rodzaj czcionki dodaj±c do niej styl Bold. Je¶li CheckBox1 zosta³ odznaczony to odejmujemy styl Bold. Poni¿sza procedura jest do CheckBox2 (Italic) i jest taka sama tylko, ¿e zmienia siê styl:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.CheckBox2Click(Sender: TObject);<br> begin<br> if CheckBox2.Checked = true then<br> Form1.Font.Style := Form1.Font.Style + [fsItalic]<br> else Form1.Font.Style := Form1.Font.Style - [fsItalic];<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Teraz wypada³oby daæ mo¿liwo¶æ zmiany czcionki. Do tego pos³u¿y nam obiekt ComboBox1, pod który podczas tworzenia Form1 kazali¶my przyj±æ wszystkie nazwy zainstalowanych w systemie czcionek. Procedura jest prosta. Zmieñ czcionkê, na t±, któr± wybra³ u¿ytkownik:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.ComboBox1Change(Sender: TObject);<br> begin<br> Form1.Font.Name := ComboBox1.Text;<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>BTW: Form1 jego w³a¶ciwo¶æ Font -> Name ustawcie na Times New Roman. Teraz wszystko gra?<br> <br> Teraz kliknijcie na Button2 (Czy¶æ):</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.Button2Click(Sender: TObject);<br> begin<br> Memo1.Clear;<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Ta procedura czy¶ci zawarto¶æ Memo1.<br> <br> Na koniec trochê wiêcej kolorków, czyli ScrollBary. Kliknijcie na ScrollBar1 i wpiszcie tak± procedurê:</p><table border=0 width=100% style="border: 1 solid #2078A8" cellspacing=0 cellpadding=0 bgcolor=#E0F0F8><tr><td width=100%><div align=center><center><table border=0 width=269 cellspacing=0 cellpadding=0><tr><td width=267 height=8><p class=9ptV></td></tr><tr><td width=267 valign=top><p class=9ptV align=left><font color=#2078A8>procedure TForm1.ScrollBar1Change(Sender: TObject);<br> begin<br> Memo1.Color := RGB(ScrollBar1.Position, ScrollBar2.Position, ScrollBar3.Position);<br> Memo1.Font.Color := RGB(255,255,255)-Memo1.Color;<br> end;</font></td></tr><tr><td width=267 height=8><p class=9ptV></td></tr></table></center></div></td></tr></table><p align=justify class=9ptV>Procedura ta daje nam mo¿liwo¶æ wykorzystania 16 milionowej palety barw dla koloru t³a Memo1. Korzystamy tutaj z funkcji RGB, która bierze od nas warto¶ci trzech podstawowych kolorów (red, green, blue) i zamienia je w jeden kolor. Dodatkowo procedura daje dla tekstu Memo1 odwrotny kolor palety.<br> <br> Program zosta³ napisany. Nie jest to w ogóle praktyczne, wiêc jeszcze siê nie chwalcie kolegom, bo siê z was nie¼le wy¶miej±. Niestety takie s± pocz±tki programowania. Jeszcze jedna taka lekcja, a pó¼niej napiszemy co najmniej jaki¶ kalkulator. Pasuje?<div align=center><table border=0 width=100% cellspacing=0 cellpadding=0><tr><td width=100%><p align=right class=9ptV><font face=Arial size=1 color=#000000><img border=0 src=../img/kwad_03.gif width=8 height=8> </font><a href=http://www.magazin.prv.pl class=link><font face=Arial size=1 color=#2078A8>MZ</font></a></p></td></tr></table></div></td></tr></table></td></tr><tr><center><td width=100% height=20 valign=bottom></center><div align=center><table border=0 width=586 height=20 cellspacing=0 cellpadding=0><tr><td width=135 background=../img/line3.gif><p align=right><img border=0 src=../img/line.gif width=9 height=20></td><center><td width=310 valign=bottom><p align=center class=9ptV><a href=20.htm class=link2><font color=#2078A8>poprzednia strona</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=spis.htm class=link2><font color=#2078A8>spis tre¶ci</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=22.htm class=link2><font color=#2078A8>nastêpna strona</font></a></td><td width=135 background=../img/line3.gif><img border=0 src=../img/line2.gif width=9 height=20></td></tr></table></center></div></td></tr><tr><td width=100% height=65 valign=top background=../img/003c.png><div align=center><center><table border=0 width=592 cellspacing=0 cellpadding=0 height=55><tr><td width=590 height=55><p align=center class=9ptV><b><font color=#FFFFFF>WSZELKIE PRAWA ZASTRZE¯ONE :: COPYRIGHT &copy; LOOPUSNET/MAGAZIN 2001-2002</font></b></td></tr></table></center></div></td></tr></table></div></body></html>