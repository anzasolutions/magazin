<html><head><meta http-equiv=Content-Type content="text/html; charset=iso-8859-2"><link rel=stylesheet href=magazin.css TYPE=text/css><title>MagaZin #16 :: maj 2003</title></head><body link=#478DE7 vlink=#478DE7 alink=#478DE7 topmargin=0 bottommargin=0 bgcolor=#000000><div align=center><table border=0 width=650 style="border-style: solid; border-width: 0" cellspacing=0 cellpadding=0 height=100% bgcolor=#FFFFFF><tr><td width=100% height=70 valign=middle background=../img/003b.png><div align=center><table border=0 width=550 cellspacing=0 cellpadding=0 height=28><tr><td width=550 align=center height=26 valign=bottom><p class=9ptV align=right><font color=#FFFFFF><b>MAGAZIN #16 :: STRONA 34</b></font></td></tr></table></div></td></tr><tr><center><td width=100% height=20 valign=bottom></center><div align=center><table border=0 width=586 height=20 cellspacing=0 cellpadding=0><tr><td width=135 background=../img/line3.gif><p align=right><img border=0 src=../img/line.gif></td><center><td width=330 valign=bottom><p align=center class=9ptV><a href=33.htm class=link2><font color=#2078A8>poprzednia strona</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=spis.htm class=link2><font color=#2078A8>spis tre¶ci</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=35.htm class=link2><font color=#2078A8>nastêpna strona</font></a></td><td width=135 background=../img/line3.gif><img border=0 src=../img/line2.gif width=9 height=20></td></tr></table></center></div></td></tr><tr><td width=100% height=5 valign=top><p class=9ptV>&nbsp;</td></tr><tr><td width=100% height=5 valign=top background=../img/back3b.gif><div align=center><table border=0 width=600 cellspacing=0 cellpadding=0><tr><td width=590 valign=top class=9ptV height=20 style="border-bottom: 1 solid #2078A8" colspan=4 bgcolor=#FFFFFF><b><font color=#009830><img border=0 src=../img/kwad.gif width=8 height=8> </font><font color=#2078A8>KURSY</font></b></td></tr><tr><td width=1 valign=top height=66><p align=right></td><td width=60 valign=top height=66><div align=center><center><table border=0 width=100% cellspacing=0 cellpadding=0 height=60><tr><td width=60 valign=bottom height=57><p align=right><img border=0 src=../img/m_direct_big.gif width=50 height=50></td></tr></table></center></div></td><td width=537 valign=middle height=70><i><font face=Impact size=7 color=#BD1E1E>&nbsp;</font><font face=Impact size=7 color=#2078A8>Kurs Delphi, cz. 7</font></i></td><td width=1 valign=bottom height=66></td></tr></table></div></td></tr><tr><center><td width=100% height=5 valign=top background=../img/back3b.gif></center><div align=center><table border=0 width=550 cellspacing=0 cellpadding=0><tr><td width=588 height=5></td></tr><tr><td width=588 valign=middle class=9ptV height=20 style="border-top: 1 solid #C0C0C0; border-bottom: 1 solid #C0C0C0"><div align=center><table border=0 width=570 cellspacing=0 cellpadding=0 height=25><tr><td width=100%><p align=center><font color=#009830>&nbsp;<img border=0 src=../img/goto3.gif> </font><a href=mailto:przempc@poczta.onet.pl class=link2><b><font color=#2078A8>PC</font></b><font color=#2078A8><b>3T</b></font></a></p></td></tr></table></div></td></tr><tr><td width=588 height=5></td></tr><tr><td width=588 height=10></td></tr></table></div></td></tr><center></center><center></center><tr><td width=100% height=21 valign=top background=../img/back3.gif><div align=center><center><table border=0 width=600 cellspacing=0 cellpadding=8><tr><td width=50% valign=top><p class=9ptV style="line-height: 130%" align=justify><font color=#2078A8>Witka! Chocia¿ ostatnio MagaZin jest ró¿nie wydawany, to mam jednak nadzieje, ¿e s± jeszcze jacy¶ zapaleñcy, którzy chêtnie poczytaj± moje wypociny. :) Dzisiaj napiszemy prosty Notatnik in Delphi.<br> <br> </font><font color=#000000><img border=0 src=../img/delphi72.jpg style="margin-bottom: 5" width=285 height=214></font><font color=#2078A8><br> <br> </font><img border=0 src=../img/bl2/003_n.gif style="float: left; margin-right: 4; margin-top: 4" width=24 height=40>a pocz±tek projektowanie wizualne: prawda, ¿e screen powy¿ej co¶ wam przypomina? ;) Na pocz±tek zajmiemy siê TMainMenu, kilknijcie dwa razy na obiekt.... W nowym okienku stwórzcie Plik a w nim: Nowy, Otwórz, Zapisz, Zapisz jako... pó¼niej poziom± kreskê (w Caption wpiszcie "-" [minus]) i Wyj¶cie. W Edycja: Cofnij, kreska, Wytnij, Kopiuj, Wklej, kreska, Zaznacz wszystko. Jeszcze jedna ciekawostka: kliknijcie na Cofnij i z Object Inspectora wybierzcie w³a¶ciwo¶æ ShortCut... teraz kolejno dla pozycji w menu wybierzcie: Ctr + Z, Ctrl + X, Ctrl + C i Ctrl + V. Zaznacz wszystko z regu³y nie ma skrótu. Teraz przejd¼my do Form1. Caption taki jak jest na obrazku: Notatnik in Delphi [Nowy]. Position ustawcie na poDefault. Teraz nasze okno bêdzie automatycznie przez Winodws ustawiane w nbajlpeszej pozycji oraz w najlepszym rozmiarze. Nastêpnie przechodzimy do SaveDialog1. Wszystkie trzy nastêpne obiekty, które u¿yli¶my w projekcie s± niewidzialne. TMainMenu ju¿ znacie, nowe s± TSaveDialog i TOpenDialog.<br> <br> <font color=#000000><img border=0 src=../img/delphi71.jpg style="margin-bottom: 5" width=285 height=214><br> </font><font size=1 face=Tahoma color=#2078A8><img border=0 src=../img/goto5.gif width=8 height=8> Okienko Otwórz wywo³ane dziêki TOpenDialog&nbsp;</font><br> <br> S³u¿± one do wy¶wietlania standardowych okienek Zapisz i Otwórz. Wy¶wietliæ je mo¿na tylko w kodzie, ale projektuj±c wizualnie mo¿emy ju¿ du¿o ich parametrów ustaliæ. Najpierw zerknijcie do Object Inspectora obiektu SaveDialog1. Pierwsza w³a¶ciwo¶æ mówi nam jakie standardowe rozszerzenie ma u¿yæ nasz obiekt przy zapisywaniu pliku. My damy tutaj .txt. W koñcu to Notatnik. :) Dalej mamy FileName, jest to standardowa nazwa pliku jaki bêdziemy zapisywaæ. Przy Filter trochê wiêcej siê pobawimy. Kliknijcie obok Filter dwa razy. Pojawi siê nam nowe okienko: po lewej s± nazwy roszerzeñ, po prawej ich rozszerzenia. Po prawej piszemy: Pliki tekstowe oraz ni¿ej Wszystkie pliki, a po prawej: *.txt oraz *.*. Teraz nacisnijcie OK, a w Object Inspectorze rozwiñcie Options, a w nim ofOverwritePromp ustawcie na True. Spowoduje to, ¿e program najpierw zapyta siê czy chcemy nadpisaæ plik, gdy u¿ytkownik wska¿e na plik ju¿ istniej±cy. Teraz przejd¼my na OpenDialog1. W Filter wpiszcie to samo co w SaveDialog1.Filter. W Options na True ustawcie ofFileMustExists, czyli plik otwierany musi istnieæ. :) Teraz jeszcze przejdziemy na Memo1. Align ustawcie na alClient czyli na ca³y formularz w zale¿no¶ci od jego rozmiaru. ScrollBars ustawcie na ssVertical. No i tyle wizualizacji. :)<br> <br> Zaraz po implementation w main.pas wpiszcie<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>implementation<br> <br> {$R *.DFM}<br> var<br> nazwa:String;</font><p class=9ptV style="line-height: 130%" align=justify>Zmienna ta przyda siê nam przy dalszej czê¶ci programu, teraz zdarzenie klikniêcia na Nowy:<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Nowy1Click(Sender: TObject);<br> begin<br> nazwa := '';<br> Memo1.Clear;<br> Form1.Caption := 'Notatnik in Delphi [Nowy]';<br> end;</font><p class=9ptV style="line-height: 130%" align=justify>Na razie wszystko jasne, Otwórz:<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Otwrz1Click(Sender: TObject);<br> var<br> i: Integer;<br> begin<br> if OpenDialog1.Execute then<br> begin<br> if Memo1.Modified = True then<br> begin<br> i := Application.MessageBox('Czy zapisaæ zmiany w akutalnie edytowanym pliku?', 'Zapisaæ zmiany', MB_YESNOCANCEL+MB_ICONINFORMATION);<br> if i=IDYES then Zapisz1Click(Sender);<br> if i=IDCANCEL then Exit;<br> end;<br> nazwa := OpenDialog1.FileName;<br> Memo1.Lines.LoadFromFile(nazwa);<br> Form1.Caption := 'Notatnik in Delphi [' + ExtractFileName(nazwa) + ']';<br> Memo1.Modified := False;<br> end;<br> end;</font><p class=9ptV style="line-height: 130%" align=justify>£ochocho :) trochê tego jest. Najpierw zmienna "i" typu Integer. if OpenDialog1.Execute s³u¿y do otworzenia okna Otwórz oraz sprawdzenia czy u¿ytkownik nacisn±³ Otwórz. Je¶li nie to nic dalej siê nie stanie. Niedawno pewien cz³owiek przy komentowaniu jednego z programów, który napisa³em w celach edukacyjnych podpowiedzia³ mi, ¿e lepiej jest stosowaæ tak± formê:<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>if not OpenDialog1.Execute then Exit;<br> {tutaj czê¶æ kodu gdy nacisn±³ Otwórz}</font><p class=9ptV style="line-height: 130%" align=justify>Pierwsza linijka wychodzi z procedury (procedura Exit), gdy u¿ytkownik naci¶nie Anuluj, druga czê¶æ zdarza siê wiêc tylko, gdy naci¶nie Otwórz. Obydwa sposoby dozwolone. :) Pó¼niej sprawdzamy czy w Memo1 nast±pi³y jakie¶ zmiany, je¶li tak to pytamy siê u¿ytkownika czy chcesz zapisaæ zmiany. Na koñcu tej czê¶ci bêdziecie mieli wyja¶nione jak tworzy siê okienka komunikatowe. Je¶li u¿ytkownik wybra³ Tak (if i = IDYES then Zapisz1Click(Sender);) to wykonamy procedurê zapisania, która zaraz zrobimy. Je¶li nacisn±³ Anuluj to wyjd¼ z procedury. Pó¼niej pod zmienn± nazwa, gdy ju¿ przejdziemy pierwsze trudno¶ci z zachowaniem zmian w dokumencie, podstawiamy nazwê pliku, który chce otworzyæ u¿ytkownik (OpenDialog1.FileName). Pó¼niej wczytujemy zawarto¶æ pliku do Memo1, zmieniamy Form1.Caption. Tutaj siê zatrzymamy, bo u¿y³em nowej funkcji ExtracFileName(S: String). Funkcja ta wyci±ga ze Stringa (C:\Pliki\text.txt) sam± nazwê pliku (text.txt). Jest to standard, który powinni¶cie przestrzegaæ, tj. pokazywaæ tylko nazwy krótkie, bo jakby to wygl±da³o, gdyby na górze aplikacji pojawi³o siê co¶ takiego: C:\Pliki\Moje\texty\internet\mz\<br> nowe\spam\spam.txt ? Raczej ³adniej bêdzie to wygl±da³o tak: spam.txt. Na samym koñcu ustalamy: Memo1.Modified := False. Jak wiêc dzia³a ten Modified? Na pocz±tku Memo1.Modifie równa siê False, czyli zawarto¶æ w Memo1 siê nie zmieni³a. Gdy jednak co¶ wpiszemy do Memo1, to program automatycznie ustali dla Memo1.Modified := True. Dziêki temu mo¿emy pó¼niej sprawdziæ w naszym programie czy Memo1.Modified równa siê True. Je¶li tak, to oznacza, ¿e od ostatniego razu co¶ siê zmieni³o w Memo1 i u¿ytkownik mo¿e chcieæ zapisaæ zmiany.<br> Teraz s³ynna procedura Zapisz1Click:<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Zapisz1Click(Sender: TObject);<br> begin<br> if nazwa &lt;> '' then<br> begin<br> Memo1.Lines.SaveToFile(nazwa);<br> Memo1.Modified := False;<br> end<br> else<br> if SaveDialog1.Execute then<br> begin<br> nazwa := SaveDialog1.FileName;<br> Memo1.Lines.SaveToFile(nazwa);<br> Memo1.Modified := False;<br> Form1.Caption := 'Notatnik in Delphi [' + ExtractFileName(nazwa) + ']';<br> end;<br> end;</font><p class=9ptV style="line-height: 130%" align=justify>Pierwszy warunek sprawdza czy nasz plik ma jak±¶ nazwê, je¶li warto¶æ zmiennej nazwa jest pusta, oznacza, to ¿e plik nie istnieje na dysku i trzeba najpierw daæ mo¿liwo¶æ u¿ytkownikowi wskazania jego nazwy i miejsca zapisania. Wiêc gdy nazwa jest to zapisujemy od razu. Jednak, gdy jest inaczej (nie ma nazwy, nazwa jest pusta) to otwieramy okienko SaveDialog1 (identycznie jak z OpenDialog1) i gdy u¿ytkownik wybierze nazwê to zapisujemy. Pó¼niej ustalamy zmodyfikowanie dokumentu i Form1.Caption.<br> Poni¿ej Zapisz jako..., tutaj nie sprawdzamy czy plik ma nazwê, bo w tej procedurze chodzi o to, ¿eby u¿ytkownik wybra³ now±:<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Zapiszjako1Click(Sender: TObject);<br> begin<br> if SaveDialog1.Execute then<br> begin<br> nazwa := SaveDialog1.FileName;<br> Memo1.Lines.SaveToFile(nazwa);<br> Memo1.Modified := False;<br> Form1.Caption := 'Notatnik in Delphi [' + ExtractFileName(nazwa) + ']';<br> end;<br> end;</font><p class=9ptV style="line-height: 130%" align=justify>Jest to druga czê¶æ procedury Zapisz1Click, wiêc t³umaczyæ nie muszê. Poni¿ej jeszcze prostsza procedura, zamykamy program:<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Wyjcie1Click(Sender: TObject);<br> begin<br> Form1.Close;<br> end;</font><p class=9ptV style="line-height: 130%" align=justify>Okno Form1, ma jeszcze jedno ciekawe zdarzenie: OnCloseQuery(Sender: TObject; var CanClose: Boolean); Zdarzenie to jest wywo³ywane, gdy u¿ytkownik zamyka okno (poprzez X w prawym górnym rogu lub poprzez inne zdarzenie) i ma ciekaw± warto¶æ: CanClose: Boolean. Ustawiaj±c na False nie pozwalamy zamykaæ okna, a na True pozwalamy. Po co to nam? Za³ó¿my, ¿e pracujemy nad jakim¶ plikiem, zamykamy okno bez zapisania zmian, a nasz program pyta siê czy zapisaæ jednak te zmiany. Wtedy my mamy do wyboru trzy wyj¶cia: Tak (zapisuje i wychodzi), Nie (nie zapisuje, ale wychodzi) Anuluj (nie zamyka programu, nie zapisuje zmian). Jest to jedyne zdarzenie, w którym mo¿na jeszcze anulowaæ zakoñczenie programu.<p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.FormCloseQuery(Sender: TObject; var CanClose: Boolean);</font></td><td width=50% valign=top></center><p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>var<br> i:Integer;<br> begin<br> CanClose := True;<br> if Memo1.Modified = True then<br> begin<br> i := Application.MessageBox('Czy zapisaæ zmiany w akutalnie edytowanym pliku?', 'Zapisaæ zmiany', MB_YESNOCANCEL+MB_ICONINFORMATION);<br> if i=IDYES then Zapisz1Click(Sender);<br> if i=IDCANCEL then CanClose := False;<br> end;<br> end;</font><center><p class=9ptV style="line-height: 130%" align=justify>Na pocz±tku zgadzamy siê na zamkniêcie programu, lecz póki procedura siê nie zakoñczy mo¿na jeszcze zmieniæ zdanie. :) Pó¼niej, gdy dokument nie jest zapisany pytamy siê co dalej zrobiæ. Tak - zapisaæ, Anuluj nie wychodziæ z programu. Pamiêtajcie, gdy jednak plik nie bêdzie wymaga³ zapisania, okienko siê nie pojawi. Poni¿ej kilka procedur z menu Edycja:</center><p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Cofnij1Click(Sender: TObject);<br> begin<br> Memo1.Undo; // cofnij<br> end;<br> <br> procedure TForm1.Wytnij1Click(Sender: TObject);<br> begin<br> Memo1.CutToClipboard; // wyntij<br> end;<br> <br> procedure TForm1.Kopiuj1Click(Sender: TObject);<br> begin<br> Memo1.CopyToClipboard; // kopiuj<br> end;<br> <br> procedure TForm1.Wklej1Click(Sender: TObject);<br> begin<br> Memo1.PasteFromClipboard; // wklej<br> end;<br> <br> procedure TForm1.Zaznaczwszystko1Click(Sender: TObject);<br> begin<br> Memo1.SelectAll; // zaznacz wszystko<br> end;</font><center><p class=9ptV style="line-height: 130%" align=justify>T³umaczyæ nie ma co. :) TMemo posiada kilka podstawowych procedur zwi±zanych z edycj±, których nie musimy pisaæ sami. :)<br> Teraz co¶ co mo¿e was zdziwiæ. Kliknijcie dwa razy na TMainMenu, pó¼niej raz na memu plik, w Object inspectorze wybierzcie OnClick. Có¿ to za zdarzenie?! Wywo³ywane jest ono, gdy naci¶niemy na Plik, zaraz przed wysuniêciem siê menu:</center><p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Plik1Click(Sender: TObject);<br> begin<br> Zapisz1.Enabled := Memo1.Modified;<br> end;</font><center><p class=9ptV style="line-height: 130%" align=justify>Na czym polega ta procedura? Gdy klikniemy na Plik, a nasz dokument bêdzie wymaga³ zapisania (zmodyfikowany) to Zapisz bêdzie aktywne. Jednak gdy nie bêdzie wymagane zapisanie go to Zapisz bêdzie nieaktywne. Proste? Nawet u¿yteczne. :)<br> <br> <b>Komunikaty</b><br> <br> Wy¿ej tworzyli¶my komunikaty typu.: "Czy zapisaæ zmiany w pliku?". ¯eby zrobiæ taki komunikat nie musicie wcale tworzyæ nowego okna, wstawiaæ obiektu TLabel, dwa TButton (Tak i Nie) oraz TImage i bawiæ siê w Paint'cie robi±c ikonkê. Starczy tylko wpisaæ jedn± lub kilka linijek tekstu. Na pocz±tek przyk³ad:</center><p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>procedure TForm1.Button1Click(Sender:TObject); begin Application.MessageBox('Przyk³adowy komunikat.', 'Przyk³ad', MB_OK+MB_ICONINFORMATION); end;</font><center><p class=9ptV style="line-height: 130%" align=justify>W powy¿szym przyk³adzie obs³u¿yli¶my zdarzenie naci¶niêcia przycisku. Po naci¶niêciu przycisku wy¶wietli siê nam komunikat z tekstem: Przyk³adowy komunikat. Jak widzisz jest to linijka tekstu (chodzi mi o samo wy¶wietlenie komunikatu). Do stworzenia komunikatu starczy wykorzystaæ obiekt TApplication. A teraz t³umaczê parametry:<p class=9ptV style="line-height: 130%" align=justify><font color=#2078A8>Application.MessageBox({Tutaj podajemy tekst do wy¶wietlenia typu PChar}, {Tutaj podajemy tekst nag³ówka typu PChar}, {Tutaj podajemy parametr Flags});</font><p class=9ptV style="line-height: 130%" align=justify>Pierwsze dwa parametry s± ³atwe i chyba nie muszê ich t³umaczyæ. Na szczególn± uwagê zwracamy na parametr trzeci. Jak wiecie definiujemy tu parametr Flags, a w nim ustalamy:<br> <br> - typy przycisków;<br> - typy ikon;<br> - i inne<br> <br> Szczegó³y w tabeli poni¿ej:<br> <br><div align=center><table border=0 cellspacing=0 cellpadding=6><tr><td align=center width=33% style="border-top: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><b><font color=#1F77A4>Flaga</font></b></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-top: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><b><font color=#1F77A4>Skutek</font></b></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ABORTRETRYIGNORE</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pokazuje trzy przyciski: Zrezygnuj, Ponów i Ignoruj&nbsp;</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_APPLMODAL</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>U¿ytkownik musi wybraæ jaki¶ przycisk inaczej nie wróci do aplikacji. Opcja ustawiona domy¶lnie.&nbsp;</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_DEFAULT_DESKTOP_ONLY</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>&nbsp;Pole komunikatu musi pojawiæ siê na domy¶lnym pulpicie jest to pulpit, na którym zalogowa³ siê u¿ytkownik.&nbsp;</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_DEFBUTTON1</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>&nbsp;Pierwszy przycisk komunikatu jest domy¶lny. (zaznaczony)</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_DEFBUTTON2</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Drugi przycisk komunikatu jest domy¶lny. (zaznaczony)</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_DEFBUTTON3</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Trzeci przycisk komunikatu jest domy¶lny. (zaznaczony)</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_DEFBUTTON4</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Czwarty przycisk komunikatu jest domy¶lny. (zaznaczony)</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_HELP</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Dodatkowo umieszcza przycisk Help (Pomoc)</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONASTERISK</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona z literk± "i"</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONERROR</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona z czerwonym kó³kiem, a w ¶rodku "x"</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONEXCLAMATION</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona z wykrzyknikiem.</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONHAND</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona z czerwonym kó³kiem, a w ¶rodku &quot;x&quot;</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONINFORMATION</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona z literk± "i".</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONQUESTION</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona ze znakiem zapytania.</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONSTOP</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona z czerwonym kó³kiem, a w ¶rodku "x"</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_ICONWARNING</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê ikona z wykrzyknikiem.</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_OK</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê przycisk OK</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_OKCANCEL</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê przycisk OK i Anuluj</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_RETRYCANCEL</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê przycisk Ponów i Anuluj</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_RIGHT</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Tekst w oknie jest wyrównany do prawej.</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_RTLREADING</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Tekst w oknie jest pisany od prawej do lewej (dla alfabetów)</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_SETFOREGROUND</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Okno komunikatu staje siê oknem pierwszego planu. Nie pozwala u¿ytkownikowi rozpoczêcia ¿adnej innej akcji.</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_TASKMODAL</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>&nbsp;Opcja przeciwna do MB_APPLMODAL<br></font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_YESNO</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê przycisk Tak i Nie</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><font size=1 face=Tahoma>MB_YESNOCANCEL</font></p></td><td align=center width=66% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Pojawia siê przycisk Tak, Nie i Anuluj</font></td></tr></table></div><p class=9ptV style="line-height: 130%" align=justify>Je¶li chcemy mieæ tylko przycisk OK i znak "!" to piszemy:</center><p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>Application.MessageBox('TEKST', 'TEST', MB_YESNO+MB_ICONWARNING);</font><center><p class=9ptV style="line-height: 130%" align=justify>Resztê pozostawiam wam do przetestowania. Pozostaje jeszcze pytanie jak sprawdziæ jaki przycisk nacisn±³ u¿ytkownik? S± na to dwa sposoby: mo¿na podstawiæ pod zmienn± wynik funkcji MessageBox (tak to jest funkcja, czyli zwraca warto¶æ) lub u¿yæ warunku case of. Podstawianie pod zmienn± mieli¶cie w powy¿szym programie, poka¿ê jeszcze case of, ale najpierw tabelka jakie warto¶ci odpowiadaj± jakim przyciskom:<br> <br><div align=center><table border=0 cellspacing=0 cellpadding=6><tr><td align=center width=33% style="border-top: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><b><font color=#1F77A4>Nazwa zwracanej warto¶ci</font></b></p></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-top: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><b><font color=#1F77A4>Zwracana warto¶æ ca³kowita</font></b></p></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-top: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD><p class=9ptV><b><font color=#1F77A4>Ma taki skutek</font></b></p></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font size=1 face=Tahoma>;</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>0</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font size=1 face=Tahoma>Zabrak³o pamiêci do wy¶wietlenia komunikatu</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font face=Tahoma size=1>IDABORT</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>3</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>Wybrano Zrezygnuj</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font face=Tahoma size=1>IDCANCEL</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>2</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>Wybrano Anuluj</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font face=Tahoma size=1>IDIGNORE</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>5</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>Wybrano Ignoruj</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font face=Tahoma size=1>IDNO</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>7</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>Wybrano Nie</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font face=Tahoma size=1>IDOK</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>1</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>Wybrano OK</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font face=Tahoma size=1>IDRETRY</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>4</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>Wybrano Ponów</font></td></tr><tr><td align=center width=33% style="border-bottom: 1 solid #1F77A4" bgcolor=#F2FAFD class=9ptV><font face=Tahoma size=1>IDYES</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>6</font></td><td align=center width=33% style="border-left: 1 solid #1F77A4; border-bottom: 1 solid #1F77A4" class=9ptV><font face=Tahoma size=1>Wybrano Tak</font></td></tr></table></div><p class=9ptV style="line-height: 130%" align=justify>Mo¿na stosowaæ dwie formy:<br> <br> <font color=#2078A8>Application.MessageBox({itd}) = IDYES</font><br> <br> lub<br> <br> <font color=#2078A8>Application.MessageBox({itd}) = 6.</font><br> <br> Skutek taki sam. Ja radzê stosowaæ ze sta³ymi przycisków, bo wtedy ³atwiej siê po³apaæ w ¼ródle programu:</center><p class=9ptV style="line-height: 130%" align=left><font color=#2078A8>case Application.MessabeBox('Tekst', 'Tytu³', MB_YESNOCANCEL+MB_ICONWARNING) of<br> IDYES: {wybrano tak};<br> IDNO: {wybrano nie};<br> IDCANCEL: {wybrano anuluj};<br> end;</font><center><p class=9ptV style="line-height: 130%" align=justify>Oczywi¶cie zamiast tych nawiasów piszemy kod odpowiadaj±cy za wynik naszego okienka.<br> To na tyle dzisiaj, do zobaczenia.<br> <br> Muszê co¶ wam powiedzieæ: wiecie jak w szpitalu czytali przycisk Cancel? Kancel! Ani to po polsku, ani po angielsku. By³o tam te¿ wiêcej smaczków i prawie podczas badañ z krzes³a nie spad³em! :) (acha: cancel powinno siê czytaæ mniej wiêcej tak: kensel)&nbsp;</center><div align=center><table border=0 width=100% cellspacing=0 cellpadding=0><center><tr><td width=100%><p align=right class=9ptV><font face=Arial size=1><br> <a href=http://www.magazin.prv.pl><img border=0 src=../img/cd.gif width=47 height=20></a></font></p></td></tr></table></div></center></td></tr></table></div></td></tr><tr><center><td width=100% height=20 valign=bottom></center><div align=center><table border=0 width=586 height=20 cellspacing=0 cellpadding=0><tr><td width=135 background=../img/line3.gif><p align=right><img border=0 src=../img/line.gif></td><center><td width=330 valign=bottom><p align=center class=9ptV><a href=33.htm class=link2><font color=#2078A8>poprzednia strona</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=spis.htm class=link2><font color=#2078A8>spis tre¶ci</font></a><font color=#4048A8> </font><font color=#2078A8>::</font><font color=#4048A8> </font><a href=35.htm class=link2><font color=#2078A8>nastêpna strona</font></a></td><td width=135 background=../img/line3.gif><img border=0 src=../img/line2.gif width=9 height=20></td></tr></table></center></div></td></tr><tr><td width=100% height=65 valign=top background=../img/003c.png><div align=center><center><table border=0 width=592 cellspacing=0 cellpadding=0 height=55><tr><td width=590 height=55><p align=center class=9ptV><b><font color=#FFFFFF>WSZELKIE PRAWA ZASTRZE¯ONE :: COPYRIGHT &copy; MAGAZIN 2001-2003</font></b></td></tr></table></center></div></td></tr></table></div></body></html>